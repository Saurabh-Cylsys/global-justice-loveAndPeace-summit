<app-peacekeeper-leftpanel></app-peacekeeper-leftpanel>

<div
  id="main"
  class="main body-content"
  [ngStyle]="{ 'margin-left': (isCollapsed || isMobileView) ? '0px' : '220px' }"
>
  <app-peacekeeper-header></app-peacekeeper-header>

  <div class="section">
    <h2 class="main-heading">Edit Badge</h2>
    <div class="row">
      <p>General Information</p>
      <div class="col-md-9">
        <div
          class="card p-2 mb-3"
          style="box-shadow: 0px 2px 5px 0px #d6d6d6; border: none"
        >
          <div class="d-flex justify-content-center">
            <div class="select-image-div">
              <!-- <input type="file" id="fileInput" > -->
              <br />
              <!-- <div class="pre"><img id="preview" [src]="this.PeaceBadgeData?.file_name">
                              <button class="select-image" >
                                  <img src="assets/UIComponents/images/peacekeeper/camera.png" alt="">
                              </button>


                          </div> -->

              <div class="profile-container">
                <label for="file-input" class="profile-label">
                  <img
                    [src]="imageUrl"
                    alt="Profile Image"
                    class="profile-image"
                  />
                  <div class="upload-icon">
                    <img
                      src="assets/UIComponents/images/peacekeeper/camera.png"
                      alt="Upload"
                    />
                  </div>
                </label>
                <input
                  type="file"
                  id="file-input"
                  type="file"
                  style="cursor: pointer"
                  accept="image/jpg,image/png,image/jpeg"
                  name="profile_picture"
                  #fileInput
                  (change)="onFileChange($event)"
                  hidden
                />
              </div>
            </div>
          </div>
          <form [formGroup]="editBadgeForm">
            <div class="row">
              <div class="col-md-4 p-3">
                <div class="mb-3 input">
                  <label for="first" class="mb-1"
                    >Full Name : <span class="text-danger">*</span></label
                  >
                  <div class="input-group flex-nowrap rounded">
                    <input
                      formControlName="full_name"
                      type="text"
                      id="fullName"
                      #fullName
                      class="w-100 border-0 input-field"
                      (keypress)="ValidateAlpha($event)"
                      (input)="onInput($event, 'full_name')"
                      placeholder="Enter Full Name"
                      aria-label=""
                      aria-describedby="addon-wrapping"
                    />
                    <span
                      class="border-0 icon"
                      id="addon-wrapping"
                      ><i class="fa-solid fa-pencil"></i
                    ></span>
                  </div>
                </div>
                <div
                  class="text-danger"
                  *ngIf="
                    getcontrol('full_name')?.errors &&
                    getcontrol('full_name')?.touched
                  "
                >
                  <small
                    class="text-danger"
                    *ngIf="getcontrol('full_name')?.errors?.['required']"
                    >Full name is required</small
                  >
                  <small
                    class="text-danger"
                    *ngIf="getcontrol('full_name')?.errors?.['minlength']"
                    >Full name must be at least 3 characters long.</small
                  >
                </div>
              </div>

              <div class="col-md-4 p-3">
                <div class="mb-3 input">
                  <label for="password" class="mb-1"
                    >DOB : <span class="text-danger">*</span></label
                  >
                  <div class="input-group flex-nowrap rounded mt-1">
                    <input
                      type="text"
                      class="p-0 w-100 border-0 input-field"
                      placeholder="Select Date of birth"
                      id="dob"
                      #dob
                      formControlName="dob"
                      [minDate]="minDate1"
                      [maxDate]="maxDate1"
                      (keydown)="disableManualInput($event)"
                      (ngModelChange)="onDateChange($event)"
                      bsDatepicker
                      [bsConfig]="{
                        isAnimated: true,
                        dateInputFormat: 'DD/MM/YYYY',
                        showWeekNumbers: false,
                        containerClass: colorTheme
                      }"
                      readonly
                    />
                  </div>
                </div>
                <div
                  class="text-danger"
                  *ngIf="
                    getcontrol('dob')?.errors && getcontrol('dob')?.touched
                  "
                >
                  <small
                    class="text-danger"
                    *ngIf="getcontrol('dob')?.errors?.['required']"
                    >Date of birth is required</small
                  >
                </div>
              </div>

              <div class="col-md-4 p-3">
                <div class="mb-3 input">
                  <label for="country"
                    >Country : <span class="text-danger">*</span></label
                  >
                  <div class="input-group flex-nowrap rounded mt-2">
                    <select
                      formControlName="country"
                      style="cursor: pointer"
                      class="form-select w-100 p-0 px-2"
                      required
                      id="country"
                      #country
                      data-error="Please select country"
                      autocomplete="off"
                      (change)="getCountrycode(code)"
                    >
                      <option selected value="" disabled>
                        --Please select country--
                      </option>
                      <option
                        *ngFor="let code of code; let j = index"
                        [value]="code.name"
                      >
                        {{ code.name }}
                      </option>
                    </select>
                  </div>
                </div>
                <div
                  *ngIf="
                    getcontrol('country')?.errors &&
                    getcontrol('country')?.touched
                  "
                >
                  <small
                    class="text-danger"
                    *ngIf="getcontrol('country')?.errors?.['required']"
                    >Country is required</small
                  >
                </div>
              </div>

              <div class="col-md-6 p-3">
                <div class="mb-3 input">
                  <label for="password" class="mb-1"
                    >Mobile Number : <span class="text-danger">*</span></label
                  >
                  <div class="input-group flex-nowrap rounded">

                    <ngx-intl-tel-input
                      class="custom-width-container w-100 border-0 input-field"
                      [preferredCountries]="[
                        CountryISO.UnitedStates,
                        CountryISO.India,
                        CountryISO.UnitedKingdom
                      ]"
                      [enableAutoCountrySelect]="true"
                      [enablePlaceholder]="false"
                      [searchCountryFlag]="true"
                      [searchCountryField]="[
                        SearchCountryField.Iso2,
                        SearchCountryField.Name
                      ]"
                      [selectFirstCountry]="false"
                      [selectedCountryISO]="CountryISO.UnitedArabEmirates"
                      [phoneValidation]="true"
                      [separateDialCode]="true"
                      [maxLength]="12"
                      [(ngModel)]="mobile_number"
                      name="mobile_number"
                      name="mobile_number"
                      id="number_mobile1"
                      #number_mobile1
                      formControlName="mobile_number"
                      (keydown)="onMobileKeyDown($event, mobile_number)"
                      (keypress)="keyPressNumbers($event, mobile_number)"
                      (paste)="onPasteMobileNumber($event)"
                                          autocomplete="off"
                    ></ngx-intl-tel-input>
                  </div>
                </div>
                <small class="text-danger" *ngIf="mobile_numberVal">
                  (Country code + Mobile number) will be 7 to 15 digits based on
                  country.
                </small>
                <div
                  *ngIf="
                    getcontrol('mobile_number')?.errors &&
                    getcontrol('mobile_number')?.touched
                  "
                >
                  <small
                    class="text-danger"
                    *ngIf="getcontrol('mobile_number')?.errors?.['required']"
                    >Mobile number is required</small
                  >
                  <small
                    class="text-danger"
                    *ngIf="
                      !mobile_numberVal &&
                      getcontrol('mobile_number')?.invalid &&
                      getcontrol('mobile_number')?.touched
                    "
                  >
                    {{ getPhoneErrorMessage() }}
                  </small>
                </div>
              </div>

              <div class="col-md-6 p-3">
                <div class="mb-3 input">
                  <label for="password" class="mb-1"
                    >E-Mail : <span class="text-danger">*</span></label
                  >
                  <div class="input-group flex-nowrap rounded">
                    <input
                      formControlName="email_id"
                      type="text"
                      class="w-100 border-0 input-field"
                      readonly
                      id="email"
                      #email
                      placeholder="Enter Email"
                      autocomplete="off"
                      (keypress)="ValidateAlpha($event)"
                      (input)="onInput($event, 'email_id')"
                      aria-label=""
                      aria-describedby="addon-wrapping"
                    />
                  </div>
                </div>
                <div class="help-block with-errors"></div>
                <div
                  *ngIf="
                    getcontrol('email_id')?.errors &&
                    getcontrol('email_id')?.touched
                  "
                >
                  <small
                    class="text-danger"
                    *ngIf="getcontrol('email_id')?.errors?.['required']"
                    >Email is required.</small
                  >
                  <small
                    class="text-danger"
                    *ngIf="getcontrol('email_id')?.errors?.['email_id']"
                    >Please enter valid email address.</small
                  >
                </div>
              </div>

              <div
                class="col-md-12 contianer-fluid mb-3"
                style="text-align: center"
              >
                <button
                  class="btn btn-success px-3"
                  (click)="updatePeacekeeper()"
                >
                  Update
                </button>
              </div>
            </div>
          </form>
        </div>
      </div>
      <div class="col-md-3">
        <div class="card border-0">
          <div class="card-body p-0">
            <!-- <img src="assets/UIComponents/images/peacekeeper/Badge.jpg" alt="" class="mb-2 w-100"> -->
            <img
              loading="eager"
              [src]="peaceBadge"
              class="w-100"
              alt=""
              width="100px"
            />
          </div>

          <button *ngIf="peaceBadge" (click)="openPopup()" class="btn btn-success w-100">
            Preview
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

<div
  *ngIf="isPeaceOn == 2"
  [ngStyle]="{ display: display }"
  class="modal"
  closeLabel="Close"
  id="trustUntrust_alert"
  #trustUntrust_alert
  tabindex="-1"
  role="dialog"
>
  <div class="modal-dialog come-from-modal new_dialog1">
    <div class="modal-content p-3">
      <!-- <button class="modal-close" (click)="closeModal()">X</button> -->

      <!-- <div class="cropper-container"> -->
      <image-cropper
        *ngIf="imageChangedEvent"
        [imageChangedEvent]="imageChangedEvent"
        (imageCropped)="imageCropped($event)"
        [maintainAspectRatio]="true"
        [resizeToWidth]="1024"
        [cropperMinWidth]="100"
        [cropperMinHeight]="100"
        [transform]="transform"
        [style.width]="'100%'"
      >
      </image-cropper>
      <!-- Zoom Buttons -->
      <!-- <div class="zoom-controls">
    <button class="zoom-button" (click)="zoomIn()">+</button>
    <button class="zoom-button" (click)="zoomOut()">-</button>
  </div>
      </div> -->

      <div class="col-md-12 row justify-content-center mb-4 mt-1">
        <div class="col-md-4 col-6">
          <button
            class="btn btn-success w-100"
            data-dismiss="modal"
            (click)="cropperReady()"
            style="height: 36px; font-size: 15px"
          >
            Crop
          </button>
        </div>
        <div class="col-md-4 col-6">
          <button
            class="btn btn-success w-100"
            data-dismiss="modal"
            (click)="closeImageModal()"
            style="
              height: 36px;
              font-size: 15px;
              background-color: #ffff;
              color: #198754;
            "
          >
            Cancel
          </button>
        </div>
      </div>
    </div>
  </div>
</div>


<div
  *ngIf="isPeaceOn == 0"
  [ngStyle]="{ display: display }"
  class="modal"
  closeLabel="Close"
  id="trustUntrust_alert"
  #trustUntrust_alert
  tabindex="-1"
  role="dialog"
>
  <div class="modal-dialog come-from-modal new_dialog1 bgModal">
    <div class="modal-content">
      <!-- <button class="modal-close" (click)="closeModal()">X</button> -->

          <div id="capture">
        <ng-container>
          <table class="main w-100" style="margin: auto">
            <tr>
              <td style="position: relative">
                <img loading="eager"
                  [src]="peaceBadge"
                  class="w-100 cpImg"
                  alt=""
                  width="100px"
                />
              </td>
            </tr>
          </table>

        </ng-container>
      </div>
      <div class="col-md-12 row ms-2 my-3" style="width: 95%">
        <div class="col-6">
          <button
            class="btn btn-success w-100"
            (click)="downloadImage()"
            style="height: 36px; font-size: 15px"
          >
            Download now
          </button>
        </div>
        <div class="col-6">
          <button
            class="btn btn-success w-100"
            (click)="closeModal()"
            style="
              height: 36px;
              font-size: 15px;
              background-color: #ffff;
              color: #198754;
            "
          >
            Close
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
